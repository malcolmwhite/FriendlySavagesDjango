(function(d){var b,c=[],e=".sm2-bar-ui",a;soundManager.setup({html5PollingInterval:50,flashVersion:9});soundManager.onready(function(){var f,h,g;f=a.dom.getAll(e);if(f&&f.length){for(h=0,g=f.length;h<g;h++){c.push(new b(f[h]))}}});a={array:(function(){function g(i){var h;return function(k,j){if(k[i]<j[i]){h=-1}else{if(k[i]>j[i]){h=1}else{h=0}}return h}}function f(m){var l,k,h;for(l=m.length-1;l>0;l--){k=Math.floor(Math.random()*(l+1));h=m[l];m[l]=m[k];m[k]=h}return m}return{compare:g,shuffle:f}}()),css:(function(){function g(l,k){return(l.className!==undefined?new RegExp("(^|\\s)"+k+"(\\s|$)").test(l.className):false)}function h(l,k){if(!l||!k||g(l,k)){return false}l.className=(l.className?l.className+" ":"")+k}function i(l,k){if(!l||!k||!g(l,k)){return false}l.className=l.className.replace(new RegExp("( "+k+")|("+k+")","g"),"")}function j(n,m,l){var k={className:n.className};i(k,m);h(k,l);n.className=k.className}function f(m,k){var l,n;l=g(m,k);n=(l?i:h);n(m,k);return !l}return{has:g,add:h,remove:i,swap:j,toggle:f}}()),dom:(function(){function g(){var j,h,i;if(arguments.length===1){j=document.documentElement;h=arguments[0]}else{j=arguments[0];h=arguments[1]}if(j&&j.querySelectorAll){i=j.querySelectorAll(h)}return i}function f(){var h=g.apply(this,arguments);if(h&&h.length){h=h[h.length-1]}return h}return{get:f,getAll:g}}()),position:(function(){function g(h){var i=0;if(h.offsetParent){while(h.offsetParent){i+=h.offsetLeft;h=h.offsetParent}}else{if(h.x){i+=h.x}}return i}function f(i){var h=0;if(i.offsetParent){while(i.offsetParent){h+=i.offsetTop;i=i.offsetParent}}else{if(i.y){h+=i.y}}return h}return{getOffX:g,getOffY:f}}()),style:(function(){function f(h,g){var i;if(h.currentStyle){i=h.currentStyle[g]}else{if(d.getComputedStyle){i=document.defaultView.getComputedStyle(h,null).getPropertyValue(g)}}return i}return{get:f}}()),events:(function(){var h,f,g;h=function(l,k,j){var i={detach:function(){return f(l,k,j)}};if(d.addEventListener){l.addEventListener(k,j,false)}else{l.attachEvent("on"+k,j)}return i};f=(d.removeEventListener!==undefined?function(k,j,i){return k.removeEventListener(j,i,false)}:function(k,j,i){return k.detachEvent("on"+j,i)});g=function(i){if(i.preventDefault){i.preventDefault()}else{i.returnValue=false;i.cancelBubble=true}return false};return{add:h,preventDefault:g,remove:f}}()),features:(function(){var l,n,i,f,m,j,g;j=document.createElement("div");n=(d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||d.oRequestAnimationFrame||d.msRequestAnimationFrame||null);l=n?function(){return n.apply(d,arguments)}:null;function k(p){var o=j.style[p];return(o!==undefined?p:null)}i={transform:{ie:k("-ms-transform"),moz:k("MozTransform"),opera:k("OTransform"),webkit:k("webkitTransform"),w3:k("transform"),prop:null},rotate:{has3D:false,prop:null},getAnimationFrame:l};i.transform.prop=(i.transform.w3||i.transform.moz||i.transform.webkit||i.transform.ie||i.transform.opera);function h(o){try{j.style[g]=o}catch(p){return false}return !!j.style[g]}if(i.transform.prop){g=i.transform.prop;m={css_2d:"rotate(0deg)",css_3d:"rotate3d(0,0,0,0deg)"};if(h(m.css_3d)){i.rotate.has3D=true;f="rotate3d"}else{if(h(m.css_2d)){f="rotate"}}i.rotate.prop=f}j=null;return i}())};b=function(f){var n,v,j,i,r,m,g,y;n={disabled:"disabled",selected:"selected",active:"active",legacy:"legacy",noVolume:"no-volume"};v={o:null,playlist:null,playlistTarget:null,playlistContainer:null,time:null,player:null,progress:null,progressTrack:null,progressBar:null,duration:null,volume:null};j={loadFailedCharacter:'<span title="Failed to load/play." class="load-error">âœ–</span>'};function t(){var D;D={playlist:[],selectedIndex:0,loopMode:false,timer:null};function F(){return D.playlist}function J(N){var M,L;if(D.selectedIndex===null){return N}M=F();N=(N!==undefined?N:D.selectedIndex);N=Math.max(0,Math.min(N,M.length));L=M[N];return L}function B(N){var O,M,L,P;P=-1;O=F();if(O){for(M=0,L=O.length;M<L;M++){if(O[M]===N){P=M;break}}}return P}function E(){if(D.selectedIndex!==null){D.selectedIndex++}if(D.playlist.length>1){if(D.selectedIndex>=D.playlist.length){if(D.loopMode){D.selectedIndex=0}else{D.selectedIndex--}}}else{D.selectedIndex=null}return J()}function K(){D.selectedIndex--;if(D.selectedIndex<0){if(D.loopMode){D.selectedIndex=D.playlist.length-1}else{D.selectedIndex++}}return J()}function C(){var L,N,M;L=a.dom.getAll(v.playlist,"."+n.selected);for(N=0,M=L.length;N<M;N++){a.css.remove(L[N],n.selected)}}function H(L){var M;C();if(L){a.css.add(L,n.selected)}M=B(L);D.selectedIndex=M}function A(){var M,L;M=J();if(M){L=M.getElementsByTagName("a")[0].href}return L}function G(){if(!v.playlist){if(d.console&&console.warn){console.warn("refreshDOM(): playlist node not found?")}return false}D.playlist=v.playlist.getElementsByTagName("li")}function z(){v.playlistTarget=a.dom.get(v.o,".sm2-playlist-target");v.playlistContainer=a.dom.get(v.o,".sm2-playlist-drawer");v.playlist=a.dom.get(v.o,".sm2-playlist-bd")}function I(){z();G()}I();return{data:D,refresh:G,getNext:E,getPrevious:K,getItem:J,getURL:A,select:H}}function w(D,E){var z=Math.floor(D/1000),B=Math.floor(z/3600),A=Math.floor(z/60)-Math.floor(B*60),C=Math.floor(z-(B*3600)-(A*60));return(E?((B?B+":":"")+(B&&A<10?"0"+A:A)+":"+(C<10?"0"+C:C)):{min:A,sec:C})}function l(A){var z=A.getElementsByTagName("a");if(z.length){A=z[0]}v.playlistTarget.innerHTML='<ul class="sm2-playlist-bd"><li>'+A.innerHTML.replace(j.loadFailedCharacter,"")+"</li></ul>";if(v.playlistTarget.getElementsByTagName("li")[0].scrollWidth>v.playlistTarget.offsetWidth){v.playlistTarget.innerHTML='<ul class="sm2-playlist-bd"><li><marquee>'+A.innerHTML+"</marquee></li></ul>"}}function q(z){var A=soundManager.createSound({url:z,whileplaying:function(){var D=100,C,B;C=Math.min(D,Math.max(0,(D*(this.position/this.durationEstimate))))+"%";B=Math.min(100,Math.max(0,(100*this.position/this.durationEstimate)))+"%";if(this.duration){v.progress.style.left=C;v.progressBar.style.width=B;v.time.innerHTML=w(this.position,true)}},onbufferchange:function(B){if(B){a.css.add(v.o,"buffering")}else{a.css.remove(v.o,"buffering")}},onplay:function(){a.css.swap(v.o,"paused","playing")},onpause:function(){a.css.swap(v.o,"playing","paused")},onresume:function(){a.css.swap(v.o,"paused","playing")},whileloading:function(){if(!this.isHTML5){v.duration.innerHTML=w(this.durationEstimate,true)}},onload:function(B){if(B){v.duration.innerHTML=w(this.duration,true)}else{if(this._iO&&this._iO.onerror){this._iO.onerror()}}},onerror:function(){var D,C,B;D=i.getItem();if(D){if(j.loadFailedCharacter){v.playlistTarget.innerHTML=v.playlistTarget.innerHTML.replace("<li>","<li>"+j.loadFailedCharacter+" ");if(i.data.playlist&&i.data.playlist[i.data.selectedIndex]){C=i.data.playlist[i.data.selectedIndex].getElementsByTagName("a")[0];B=C.innerHTML;if(B.indexOf(j.loadFailedCharacter)===-1){C.innerHTML=j.loadFailedCharacter+" "+B}}}}if(navigator.userAgent.match(/mobile/i)){m.next()}else{if(i.data.timer){d.clearTimeout(i.data.timer)}i.data.timer=d.setTimeout(m.next,1000)}},onstop:function(){a.css.remove(v.o,"playing")},onfinish:function(){var C,B;a.css.remove(v.o,"playing");v.progress.style.left="0%";C=i.data.selectedIndex;B=i.getNext();if(B&&i.data.selectedIndex!==C){i.select(B);l(B);this.play({url:i.getURL()})}}});return A}function o(z){if(z&&((z.which&&z.which===2)||(z.which===undefined&&z.button!==1))){return true}}function s(B){var z,A;A=B.target||B.srcElement;if(o(B)){return true}if(A.nodeName.toLowerCase()!=="a"){z=A.getElementsByTagName("a");if(z&&z.length){A=A.getElementsByTagName("a")[0]}}if(a.css.has(A,"sm2-volume-control")){g.volume.x=a.position.getOffX(A);g.volume.y=a.position.getOffY(A);g.volume.width=A.offsetWidth;g.volume.height=A.offsetHeight;g.volume.backgroundSize=parseInt(a.style.get(A,"background-size"),10);if(d.navigator.userAgent.match(/msie|trident/i)){g.volume.backgroundSize=(g.volume.backgroundSize/g.volume.width)*100}a.events.add(document,"mousemove",m.adjustVolume);a.events.add(document,"mouseup",m.releaseVolume);return m.adjustVolume(B)}}function p(z){if(soundManager.canPlayLink(z)){if(!r){r=q(z.href)}r.stop();i.select(z.parentNode);l(z.parentNode);r.play({url:z.href,position:0})}}function k(F){var z,E,G,C,B,A,D;z=(F||d.event);E=z.target||z.srcElement;if(E&&E.nodeName){C=E.nodeName.toLowerCase();if(C!=="a"){if(E.parentNode){do{E=E.parentNode;C=E.nodeName.toLowerCase()}while(C!=="a"&&E.parentNode);if(!E){return false}}}if(C==="a"){A=E.href;if(soundManager.canPlayLink(E)){if(!a.css.has(E,"sm2-exclude")){p(E);D=true}}else{G=E.href.lastIndexOf("#");if(G!==-1){B=E.href.substr(G+1);if(B&&m[B]){D=true;m[B](F)}}}if(D){return a.events.preventDefault(z)}}}}function h(F){var E,C,B,z,A,D;E=v.progressTrack;C=a.position.getOffX(E);B=E.offsetWidth;z=(F.clientX-C);A=(z/B);D=r;if(D&&D.duration){D.setPosition(D.duration*A);D._iO.whileplaying.apply(D)}if(F.preventDefault){F.preventDefault()}return false}function x(z){a.events.remove(document,"mousemove",h);a.css.remove(v.o,"grabbing");if(z.preventDefault){z.preventDefault()}a.events.remove(document,"mouseup",x);return false}function u(){if(!f){console.warn("init(): No playerNode element?")}v.o=f;if(d.navigator.userAgent.match(/msie [678]/i)){a.css.add(v.o,n.legacy)}if(d.navigator.userAgent.match(/mobile/i)){a.css.add(v.o,n.noVolume)}v.progress=a.dom.get(v.o,".sm2-progress-ball");v.progressTrack=a.dom.get(v.o,".sm2-progress-track");v.progressBar=a.dom.get(v.o,".sm2-progress-bar");v.volume=a.dom.get(v.o,"a.sm2-volume-control");v.duration=a.dom.get(v.o,".sm2-inline-duration");v.time=a.dom.get(v.o,".sm2-inline-time");i=new t();y=i.getItem(0);i.select(y);l(y);a.events.add(v.o,"mousedown",s);a.events.add(v.o,"click",k);a.events.add(v.progressTrack,"mousedown",function(z){if(o(z)){return true}a.css.add(v.o,"grabbing");a.events.add(document,"mousemove",h);a.events.add(document,"mouseup",x);return h(z)})}g={volume:{x:0,y:0,width:0,height:0,backgroundSize:0}};m={play:function(B){var A,z;A=B.target||B.srcElement;z=A.href;if(z.indexOf("#")!==-1){z=v.playlist.getElementsByTagName("a")[0].href}if(!r){r=q(z)}r.togglePause()},next:function(){var z,A;if(i.data.timer){d.clearTimeout(i.data.timer);i.data.timer=null}A=i.data.selectedIndex;z=i.getNext(true);if(z&&i.data.selectedIndex!==A){p(z.getElementsByTagName("a")[0])}},prev:function(){var z,A;A=i.data.selectedIndex;z=i.getPrevious();if(z&&i.data.selectedIndex!==A){p(z.getElementsByTagName("a")[0])}},shuffle:function(A){var z=A.target||A.srcElement;if(!a.css.has(z.parentNode,n.disabled)){a.css.toggle(z.parentNode,n.active);i.data.shuffleMode=!i.data.shuffleMode}},repeat:function(A){var z=A.target||A.srcElement;if(!a.css.has(z,n.disabled)){a.css.toggle(z.parentNode,n.active);i.data.loopMode=!i.data.loopMode}},menu:function(){var z;z=a.css.toggle(v.o,"playlist-open");v.playlistContainer.style.height=(z?v.playlistContainer.scrollHeight:0)+"px"},adjustVolume:function(F){var A,E,z,D,C,B;C=0;D=v.volume;A=g.volume.backgroundSize;A=100-A;E=A/2;C=Math.max(0,Math.min(1,(F.clientX-g.volume.x)/g.volume.width));D.style.clip="rect(0px, "+(g.volume.width*C)+"px, "+g.volume.height+"px, "+(g.volume.width*(E/100))+"px)";z=((E/100)*g.volume.width);B=Math.max(0,Math.min(1,((F.clientX-g.volume.x)-z)/(g.volume.width-(z*2))));if(r){r.setVolume(B*100)}return a.events.preventDefault(F)},releaseVolume:function(){a.events.remove(document,"mousemove",m.adjustVolume);a.events.remove(document,"mouseup",m.releaseVolume)}};u()};d.sm2BarPlayers=c;d.SM2BarPlayer=b}(window));